                                      1 .include /asm51.h/
                           000080     1 _P0	=	0x0080
                           000081     2 _SP	=	0x0081
                           000082     3 _DPL	=	0x0082
                           000083     4 _DPH	=	0x0083
                           000087     5 _PCON	=	0x0087
                           000088     6 _TCON	=	0x0088
                           000089     7 _TMOD	=	0x0089
                           00008A     8 _TL0	=	0x008a
                           00008B     9 _TL1	=	0x008b
                           00008C    10 _TH0	=	0x008c
                           00008D    11 _TH1	=	0x008d
                           000090    12 _P1	=	0x0090
                           000098    13 _SCON	=	0x0098
                           000099    14 _SBUF	=	0x0099
                           0000A0    15 _P2	=	0x00a0
                           0000A8    16 _IE	=	0x00a8
                           0000B0    17 _P3	=	0x00b0
                           0000B8    18 _IP	=	0x00b8
                           0000D0    19 _PSW	=	0x00d0
                           0000E0    20 _ACC	=	0x00e0
                           0000F0    21 _B	=	0x00f0
                           0000C8    22 _T2CON	=	0x00c8
                           0000CA    23 _RCAP2L	=	0x00ca
                           0000CB    24 _RCAP2H	=	0x00cb
                           0000CC    25 _TL2	=	0x00cc
                           0000CD    26 _TH2	=	0x00cd
                                     27 
                           000080    28 _P0_0	=	0x0080
                           000081    29 _P0_1	=	0x0081
                           000082    30 _P0_2	=	0x0082
                           000083    31 _P0_3	=	0x0083
                           000084    32 _P0_4	=	0x0084
                           000085    33 _P0_5	=	0x0085
                           000086    34 _P0_6	=	0x0086
                           000087    35 _P0_7	=	0x0087
                           000088    36 _IT0	=	0x0088
                           000089    37 _IE0	=	0x0089
                           00008A    38 _IT1	=	0x008a
                           00008B    39 _IE1	=	0x008b
                           00008C    40 _TR0	=	0x008c
                           00008D    41 _TF0	=	0x008d
                           00008E    42 _TR1	=	0x008e
                           00008F    43 _TF1	=	0x008f
                           000090    44 _P1_0	=	0x0090
                           000091    45 _P1_1	=	0x0091
                           000092    46 _P1_2	=	0x0092
                           000093    47 _P1_3	=	0x0093
                           000094    48 _P1_4	=	0x0094
                           000095    49 _P1_5	=	0x0095
                           000096    50 _P1_6	=	0x0096
                           000097    51 _P1_7	=	0x0097
                           000098    52 _RI	=	0x0098
                           000099    53 _TI	=	0x0099
                           00009A    54 _RB8	=	0x009a
                           00009B    55 _TB8	=	0x009b
                           00009C    56 _REN	=	0x009c
                           00009D    57 _SM2	=	0x009d
                           00009E    58 _SM1	=	0x009e
                           00009F    59 _SM0	=	0x009f
                           0000A0    60 _P2_0	=	0x00a0
                           0000A1    61 _P2_1	=	0x00a1
                           0000A2    62 _P2_2	=	0x00a2
                           0000A3    63 _P2_3	=	0x00a3
                           0000A4    64 _P2_4	=	0x00a4
                           0000A5    65 _P2_5	=	0x00a5
                           0000A6    66 _P2_6	=	0x00a6
                           0000A7    67 _P2_7	=	0x00a7
                           0000A8    68 _EX0	=	0x00a8
                           0000A9    69 _ET0	=	0x00a9
                           0000AA    70 _EX1	=	0x00aa
                           0000AB    71 _ET1	=	0x00ab
                           0000AC    72 _ES	=	0x00ac
                           0000AF    73 _EA	=	0x00af
                           0000B0    74 _P3_0	=	0x00b0
                           0000B1    75 _P3_1	=	0x00b1
                           0000B2    76 _P3_2	=	0x00b2
                           0000B3    77 _P3_3	=	0x00b3
                           0000B4    78 _P3_4	=	0x00b4
                           0000B5    79 _P3_5	=	0x00b5
                           0000B6    80 _P3_6	=	0x00b6
                           0000B7    81 _P3_7	=	0x00b7
                           0000B0    82 _RXD	=	0x00b0
                           0000B1    83 _TXD	=	0x00b1
                           0000B2    84 _INT0	=	0x00b2
                           0000B3    85 _INT1	=	0x00b3
                           0000B4    86 _T0	=	0x00b4
                           0000B5    87 _T1	=	0x00b5
                           0000B6    88 _WR	=	0x00b6
                           0000B7    89 _RD	=	0x00b7
                           0000B8    90 _PX0	=	0x00b8
                           0000B9    91 _PT0	=	0x00b9
                           0000BA    92 _PX1	=	0x00ba
                           0000BB    93 _PT1	=	0x00bb
                           0000BC    94 _PS	=	0x00bc
                           0000D0    95 _P	=	0x00d0
                           0000D1    96 _F1	=	0x00d1
                           0000D2    97 _OV	=	0x00d2
                           0000D3    98 _RS0	=	0x00d3
                           0000D4    99 _RS1	=	0x00d4
                           0000D5   100 _F0	=	0x00d5
                           0000D6   101 _AC	=	0x00d6
                           0000D7   102 _CY	=	0x00d7
                           0000AD   103 _ET2	=	0x00ad
                           0000BD   104 _PT2	=	0x00bd
                           0000C8   105 _T2CON_0	=	0x00c8
                           0000C9   106 _T2CON_1	=	0x00c9
                           0000CA   107 _T2CON_2	=	0x00ca
                           0000CB   108 _T2CON_3	=	0x00cb
                           0000CC   109 _T2CON_4	=	0x00cc
                           0000CD   110 _T2CON_5	=	0x00cd
                           0000CE   111 _T2CON_6	=	0x00ce
                           0000CF   112 _T2CON_7	=	0x00cf
                           0000C8   113 _CP_RL2	=	0x00c8
                           0000C9   114 _C_T2	=	0x00c9
                           0000CA   115 _TR2	=	0x00ca
                           0000CB   116 _EXEN2	=	0x00cb
                           0000CC   117 _TCLK	=	0x00cc
                           0000CD   118 _RCLK	=	0x00cd
                           0000CE   119 _EXF2	=	0x00ce
                           0000CF   120 _TF2	=	0x00cf
                                      2 .area home (abs)
      000000                          3 .org 0x0000
      000000 02 00 1E         [24]    4 ljmp _main
      00000B                          5 .org 0x000b
      00000B 02 00 33         [24]    6 ljmp _TimerIntterupt0  ;控制输出波形频率
      00001B                          7 .org 0x001b
      00001B 02 00 3B         [24]    8 ljmp _TimerIntterupt1   ;控制持续时间
                                      9 
      00001E                         10 _main:
      00001E 75 89 10         [24]   11   mov _TMOD,#0x10  ;timer0,13bit;timer1, 16bit
      000021 D2 AF            [12]   12   setb _EA
      000023 D2 A9            [12]   13   setb _ET0
      000025 D2 AB            [12]   14   setb _ET1          ;允许中断T0，T1
      000027 74 00            [12]   15   mov a,#0x00
      000029 7A 14            [12]   16   mov r2,#20
      00002B 12 00 54         [24]   17   lcall _FindStartT0
      00002E 12 00 4B         [24]   18   lcall _StartT1     ;赋初值，启动中断
      000031                         19 01$:
      000031 80 FE            [24]   20   sjmp 01$
                                     21 
                                     22 ;--------------------------
                                     23 ;时间中断0，输出特定波形
                                     24 ;--------------------------
      000033                         25 _TimerIntterupt0:
      000033 C2 8C            [12]   26   clr _TR0
      000035 12 00 54         [24]   27   lcall _FindStartT0
      000038 B2 95            [12]   28   cpl _P1_5               ;取反输出波形，该io口连接蜂鸣器
      00003A 32               [24]   29   reti
                                     30 
                                     31   ;-----------------------
                                     32   ;时间中断1，定时改变寻址指针a
                                     33   ;-----------------------
                                     34 
      00003B                         35 _TimerIntterupt1:
      00003B C2 8E            [12]   36   clr _TR1              ;关闭定时器
      00003D DA 08            [24]   37   djnz r2,01$           ;50ms*20=1s延时，r2=0时，改变指针a，使定时器0定时时间改变
      00003F 7A 14            [12]   38   mov r2,#20
      000041 04               [12]   39   inc a                 ;a值查表，
      000042 B4 02 02         [24]   40   cjne a,#0x02,01$      ;控制指针自增次数，溢出清零
      000045 74 00            [12]   41   mov a,#0x00
      000047                         42 01$:
      000047 12 00 4B         [24]   43   lcall _StartT1
      00004A 32               [24]   44   reti
                                     45 
      00004B                         46 _StartT1:
      00004B 85 3C 8D         [24]   47   mov _TH1,0x3c
      00004E 85 B0 8B         [24]   48   mov _TL1,0xb0         ;赋定时初值
      000051 D2 8E            [12]   49   setb _TR1             ;启动定时器1
      000053 22               [24]   50   ret
                                     51 
      000054                         52 _FindStartT0:
      000054 FC               [12]   53   mov r4,a
      000055 90 00 70         [24]   54   mov dptr,#0x0070
      000058 93               [24]   55   movc a,@a+dptr
      000059 F5 8A            [12]   56   mov _TL0,a            ;查表赋值低位
      00005B 90 00 80         [24]   57   mov dptr,#0x080
      00005E EC               [12]   58   mov a,r4
      00005F 93               [24]   59   movc a,@a+dptr
      000060 F5 8C            [12]   60   mov _TH0,a            ;查表赋值高位
      000062 D2 8C            [12]   61   setb _TR0             ;启动定时器0
      000064 EC               [12]   62   mov a,r4              ;返回a的值
      000065 22               [24]   63   ret
                                     64 
                                     65 ;timer0定时初值表格
      000070                         66 .org 0x0070               ;TL
      000070 11 88                   67 .db 0x11,0x88
      000080                         68 .org 0x0080               ;TH
      000080 1E 1F                   69 .db 0x1e,0x1f
