                                      1 .include /asm51.h/
                           000080     1 _P0	=	0x0080
                           000081     2 _SP	=	0x0081
                           000082     3 _DPL	=	0x0082
                           000083     4 _DPH	=	0x0083
                           000087     5 _PCON	=	0x0087
                           000088     6 _TCON	=	0x0088
                           000089     7 _TMOD	=	0x0089
                           00008A     8 _TL0	=	0x008a
                           00008B     9 _TL1	=	0x008b
                           00008C    10 _TH0	=	0x008c
                           00008D    11 _TH1	=	0x008d
                           000090    12 _P1	=	0x0090
                           000098    13 _SCON	=	0x0098
                           000099    14 _SBUF	=	0x0099
                           0000A0    15 _P2	=	0x00a0
                           0000A8    16 _IE	=	0x00a8
                           0000B0    17 _P3	=	0x00b0
                           0000B8    18 _IP	=	0x00b8
                           0000D0    19 _PSW	=	0x00d0
                           0000E0    20 _ACC	=	0x00e0
                           0000F0    21 _B	=	0x00f0
                           0000C8    22 _T2CON	=	0x00c8
                           0000CA    23 _RCAP2L	=	0x00ca
                           0000CB    24 _RCAP2H	=	0x00cb
                           0000CC    25 _TL2	=	0x00cc
                           0000CD    26 _TH2	=	0x00cd
                                     27 
                           000080    28 _P0_0	=	0x0080
                           000081    29 _P0_1	=	0x0081
                           000082    30 _P0_2	=	0x0082
                           000083    31 _P0_3	=	0x0083
                           000084    32 _P0_4	=	0x0084
                           000085    33 _P0_5	=	0x0085
                           000086    34 _P0_6	=	0x0086
                           000087    35 _P0_7	=	0x0087
                           000088    36 _IT0	=	0x0088
                           000089    37 _IE0	=	0x0089
                           00008A    38 _IT1	=	0x008a
                           00008B    39 _IE1	=	0x008b
                           00008C    40 _TR0	=	0x008c
                           00008D    41 _TF0	=	0x008d
                           00008E    42 _TR1	=	0x008e
                           00008F    43 _TF1	=	0x008f
                           000090    44 _P1_0	=	0x0090
                           000091    45 _P1_1	=	0x0091
                           000092    46 _P1_2	=	0x0092
                           000093    47 _P1_3	=	0x0093
                           000094    48 _P1_4	=	0x0094
                           000095    49 _P1_5	=	0x0095
                           000096    50 _P1_6	=	0x0096
                           000097    51 _P1_7	=	0x0097
                           000098    52 _RI	=	0x0098
                           000099    53 _TI	=	0x0099
                           00009A    54 _RB8	=	0x009a
                           00009B    55 _TB8	=	0x009b
                           00009C    56 _REN	=	0x009c
                           00009D    57 _SM2	=	0x009d
                           00009E    58 _SM1	=	0x009e
                           00009F    59 _SM0	=	0x009f
                           0000A0    60 _P2_0	=	0x00a0
                           0000A1    61 _P2_1	=	0x00a1
                           0000A2    62 _P2_2	=	0x00a2
                           0000A3    63 _P2_3	=	0x00a3
                           0000A4    64 _P2_4	=	0x00a4
                           0000A5    65 _P2_5	=	0x00a5
                           0000A6    66 _P2_6	=	0x00a6
                           0000A7    67 _P2_7	=	0x00a7
                           0000A8    68 _EX0	=	0x00a8
                           0000A9    69 _ET0	=	0x00a9
                           0000AA    70 _EX1	=	0x00aa
                           0000AB    71 _ET1	=	0x00ab
                           0000AC    72 _ES	=	0x00ac
                           0000AF    73 _EA	=	0x00af
                           0000B0    74 _P3_0	=	0x00b0
                           0000B1    75 _P3_1	=	0x00b1
                           0000B2    76 _P3_2	=	0x00b2
                           0000B3    77 _P3_3	=	0x00b3
                           0000B4    78 _P3_4	=	0x00b4
                           0000B5    79 _P3_5	=	0x00b5
                           0000B6    80 _P3_6	=	0x00b6
                           0000B7    81 _P3_7	=	0x00b7
                           0000B0    82 _RXD	=	0x00b0
                           0000B1    83 _TXD	=	0x00b1
                           0000B2    84 _INT0	=	0x00b2
                           0000B3    85 _INT1	=	0x00b3
                           0000B4    86 _T0	=	0x00b4
                           0000B5    87 _T1	=	0x00b5
                           0000B6    88 _WR	=	0x00b6
                           0000B7    89 _RD	=	0x00b7
                           0000B8    90 _PX0	=	0x00b8
                           0000B9    91 _PT0	=	0x00b9
                           0000BA    92 _PX1	=	0x00ba
                           0000BB    93 _PT1	=	0x00bb
                           0000BC    94 _PS	=	0x00bc
                           0000D0    95 _P	=	0x00d0
                           0000D1    96 _F1	=	0x00d1
                           0000D2    97 _OV	=	0x00d2
                           0000D3    98 _RS0	=	0x00d3
                           0000D4    99 _RS1	=	0x00d4
                           0000D5   100 _F0	=	0x00d5
                           0000D6   101 _AC	=	0x00d6
                           0000D7   102 _CY	=	0x00d7
                           0000AD   103 _ET2	=	0x00ad
                           0000BD   104 _PT2	=	0x00bd
                           0000C8   105 _T2CON_0	=	0x00c8
                           0000C9   106 _T2CON_1	=	0x00c9
                           0000CA   107 _T2CON_2	=	0x00ca
                           0000CB   108 _T2CON_3	=	0x00cb
                           0000CC   109 _T2CON_4	=	0x00cc
                           0000CD   110 _T2CON_5	=	0x00cd
                           0000CE   111 _T2CON_6	=	0x00ce
                           0000CF   112 _T2CON_7	=	0x00cf
                           0000C8   113 _CP_RL2	=	0x00c8
                           0000C9   114 _C_T2	=	0x00c9
                           0000CA   115 _TR2	=	0x00ca
                           0000CB   116 _EXEN2	=	0x00cb
                           0000CC   117 _TCLK	=	0x00cc
                           0000CD   118 _RCLK	=	0x00cd
                           0000CE   119 _EXF2	=	0x00ce
                           0000CF   120 _TF2	=	0x00cf
                                      2 
                                      3 .area home (abs)
      000000 00               [12]    4   nop
      000001 80p00            [24]    5 sjmp _main
      001000                          6 .org 0x1000
      001000 3F 06 5B 4F 66 6D 7D     7 .db 0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07  ;将显示表存如地址0x1000
             07
      001008 7F 6F 77 7C 39 5E 79     8 .db 0x7f,0x6f,0x77,0x7c,0x39,0x5e,0x79,0x71  ;数码管显示0~f的值
             71
                                      9 
                                     10 .area code (code)
                                     11 
                                     12 ;------------------------------------------------------------------------------
                                     13 ;主函数
                                     14 ;使数码管从右往左依次显示01234567
                                     15 ;------------------------------------------------------------------------------
      000000                         16 _main:
      000000                         17 1$:
      000000 7F 08            [12]   18   mov r7,#8
      000002 7B 00            [12]   19   mov r3,#0
      000004                         20 02$:
      000004 EB               [12]   21   mov a,r3
      000005 8B F0            [24]   22   mov b,r3
      000007 0B               [12]   23   inc r3
      000008 12r00r1E         [24]   24   lcall _display
      00000B 12r00r15         [24]   25   lcall _delay1ms
      00000E 75 80 00         [24]   26   mov _P0,#0x00
      000011 DF F1            [24]   27   djnz r7,02$
      000013 80 EB            [24]   28   sjmp 1$
                                     29 
                                     30 ;延时函数
      000015                         31 _delay1ms:      ;晶振12M
      000015 7F 0A            [12]   32   mov r7,#10    ;外层循环10次
      000017                         33 02$:
      000017 7E 32            [12]   34   mov r6,#50    ;内层循环50次
      000019                         35 01$:
      000019 DE FE            [24]   36   djnz r6,01$
      00001B DF FA            [24]   37   djnz r7,02$
      00001D 22               [24]   38   ret
                                     39   ;总时间：1+（1+2x50）x10+2=,1.013ms
                                     40 
                                     41 ;------------------------------------------------------------------------------
                                     42 ;扫描显示函数                                                                  |
                                     43 ;使用A传递显示数字，B控制显示的数码管，                                          |
                                     44 ;如：DPL=1,DPH=1表示使第一(右往左数第2)个数码管显示1                             |
                                     45 ;------------------------------------------------------------------------------
      00001E                         46 _display:
      00001E 90 10 00         [24]   47   mov dptr,#0x1000
      000021 93               [24]   48   movc a,@a+dptr
      000022 FD               [12]   49   mov r5,a                 ;读取表中数据
      000023 E5 F0            [12]   50   mov a,b
      000025 23               [12]   51   rl a
      000026 23               [12]   52   rl a                      ;_P2_2口为3-8译码器的低位，左环移与之对应
      000027 F5 A0            [12]   53   mov _P2,a
      000029 8D 80            [24]   54   mov _P0,r5
      00002B 22               [24]   55   ret
